<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NaraBooth Templates V27</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f1115; --accent: #ff7675; }
        * { box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: white; margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        
        .container { width: 100%; max-width: 450px; background: #1a1c23; padding: 20px; border-radius: 40px; border: 2px solid #333; text-align: center; }
        .header h1 { margin: 0; font-size: 26px; background: linear-gradient(45deg, #ff7675, #fab1a0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }
        
        /* Kamera Box */
        .cam-box { position: relative; border-radius: 30px; overflow: hidden; aspect-ratio: 1/1; border: 4px solid #2d3436; margin: 20px 0; }
        video { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); filter: brightness(1.1); }
        .timer { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 80px; font-weight: 800; z-index: 10; }
        .flash { position: absolute; inset: 0; background: white; opacity: 0; z-index: 11; pointer-events: none; }
        .flash.active { opacity: 1; transition: 0.1s; }

        /* Template Selector */
        .template-label { display: block; margin-bottom: 10px; font-weight: 700; color: #aaa; font-size: 12px; }
        .template-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .temp-btn { padding: 12px 5px; border-radius: 15px; border: 2px solid #333; background: #252830; color: white; cursor: pointer; font-size: 11px; font-weight: 700; transition: 0.3s; }
        .temp-btn.active { border-color: var(--accent); background: rgba(255,118,117,0.1); }

        #startBtn { width: 100%; background: linear-gradient(135deg, #ff7675, #d63031); color: white; border: none; padding: 20px; border-radius: 22px; font-size: 18px; font-weight: 800; cursor: pointer; }
        #startBtn:disabled { opacity: 0.5; }

        canvas { width: 100%; border-radius: 25px; margin-top: 25px; display: none; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .btn-save { background: #00b894; color: white; border: none; padding: 20px; border-radius: 20px; width: 100%; margin-top: 15px; display: none; font-weight: 800; cursor: pointer; }

        .footer { display: none; margin-top: 25px; padding: 15px; border-radius: 20px; background: rgba(255,255,255,0.03); font-size: 11px; border: 1px dashed #444; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>NARA BOOTH</h1>
        <p style="font-size: 9px; opacity: 0.5; letter-spacing: 2px;">V27 TEMPLATE PRO</p>
    </div>

    <div class="cam-box">
        <div id="flash" class="flash"></div>
        <div id="timer" class="timer"></div>
        <video id="v" autoplay playsinline></video>
    </div>

    <span class="template-label">PILIH GAYA FRAME:</span>
    <div class="template-grid">
        <button class="temp-btn active" onclick="setT('cute', this)">üå∏ CUTE PINK</button>
        <button class="temp-btn" onclick="setT('sky', this)">‚òÅÔ∏è SKY BLUE</button>
        <button class="temp-btn" onclick="setT('dark', this)">üåë DARK NOIR</button>
    </div>

    <button id="startBtn" onclick="run()">üì∏ MULAI SESI FOTO</button>
    
    <canvas id="c"></canvas>
    <button id="sBtn" class="save-btn" onclick="save()">üíæ SIMPAN FOTO STRIP</button>

    <div id="footer" class="footer">
        <p>Suka hasilnya? Gopay: 083825256323</p>
        <a href="https://saweria.co/narastore0719" target="_blank" style="color:var(--accent); text-decoration:none; font-weight:800;">üí∏ TRAKTIR KOPI</a>
    </div>
</div>

<script>
const v = document.getElementById('v'), c = document.getElementById('c'), ctx = c.getContext('2d');
const btn = document.getElementById('startBtn'), sBtn = document.getElementById('sBtn'), flash = document.getElementById('flash'), timer = document.getElementById('timer');

let shots = [], currentTemplate = 'cute';

const themes = {
    cute: { bg: "#fff0f3", text: "#ff8fa3", accent: "üéÄ", extras: ["üå∏", "üçì", "üß∏", "‚ú®"] },
    sky: { bg: "#e0f2fe", text: "#0ea5e9", accent: "‚òÅÔ∏è", extras: ["üéà", "üåü", "üßä", "ü´ß"] },
    dark: { bg: "#1a1a1a", text: "#ffffff", accent: "‚ö°", extras: ["üî•", "üíÄ", "üé∏", "üèÅ"] }
};

navigator.mediaDevices.getUserMedia({ video: { facingMode: "user", width: 720, height: 720 } }).then(s => v.srcObject = s);

function setT(t, el) {
    currentTemplate = t;
    document.querySelectorAll('.temp-btn').forEach(b => b.classList.remove('active'));
    el.classList.add('active');
}

async function run() {
    shots = []; c.style.display = 'none'; sBtn.style.display = 'none'; document.getElementById('footer').style.display = 'none';
    btn.disabled = true;

    for(let i=0; i<4; i++) {
        for(let l=3; l>=0; l--) {
            timer.innerText = l > 0 ? l : "";
            await new Promise(r => setTimeout(r, 1000));
        }
        flash.classList.add('active');
        snap();
        setTimeout(() => flash.classList.remove('active'), 100);
        await new Promise(r => setTimeout(r, 600));
    }
    
    render();
    c.style.display = 'block'; sBtn.style.display = 'block'; document.getElementById('footer').style.display = 'block';
    btn.disabled = false;
    c.scrollIntoView({ behavior: 'smooth' });
}

function snap() {
    const t = document.createElement('canvas');
    t.width = 800; t.height = 800;
    const tc = t.getContext('2d');
    tc.translate(800,0); tc.scale(-1,1);
    tc.drawImage(v, 0, 0, 800, 800);
    const img = new Image();
    img.src = t.toDataURL('image/png');
    shots.push(img);
}

function render() {
    const theme = themes[currentTemplate];
    c.width = 600; c.height = 1900;
    
    // Background Frame
    ctx.fillStyle = theme.bg;
    ctx.fillRect(0,0,600,1900);
    
    // Watermark/Header
    ctx.fillStyle = theme.text;
    ctx.textAlign = "center";
    ctx.font = "bold 35px 'Plus Jakarta Sans'";
    ctx.fillText("NARA BOOTH", 300, 80);
    ctx.font = "20px serif";
    ctx.fillText(theme.accent + " SPECIAL EDITION " + theme.accent, 300, 115);

    shots.forEach((img, i) => {
        const y = 160 + (i * 420);
        
        // Border Putih Foto
        ctx.fillStyle = "white";
        ctx.fillRect(45, y-5, 510, 410);
        ctx.drawImage(img, 50, y, 500, 400);

        // STIKER OTOMATIS BERDASARKAN TEMA
        ctx.font = "55px serif";
        // Stiker Kiri Atas
        ctx.fillText(theme.extras[0], 65, y+45);
        // Stiker Kanan Bawah
        ctx.fillText(theme.extras[1], 535, y+395);
        // Stiker Random Tengah Samping
        ctx.font = "35px serif";
        ctx.fillText(theme.extras[2], 25, y+200);
        ctx.fillText(theme.extras[3], 575, y+200);
    });

    // Dekorasi Paling Bawah
    ctx.font = "40px serif";
    ctx.fillText(theme.extras.join(" "), 300, 1860);
}

function save() {
    const l = document.createElement('a');
    l.download = `NaraBooth_${currentTemplate}_${Date.now()}.png`;
    l.href = c.toDataURL('image/png');
    l.click();
}
</script>
</body>
</html>
